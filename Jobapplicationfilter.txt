require ["include", "environment", "variables", "relational", "comparator-i;ascii-numeric", "spamtest"];
require ["fileinto"]; 

/* Do not run this filter on spam /
if allof (
  environment :matches "vnd.proton.spam-threshold" "",
  spamtest :value "ge" :comparator "i;ascii-numeric" "${1}"
) {
  return;
} 

/** 

    Job application confirmations (EN + DA), Subject-only.
    Uses :matches with wildcards (*) to allow punctuation/extra words.
    Excludes common rejection phrases.
    Proton Sieve doesn’t support body matching.
    @type and
    @comparator matches (i;unicode-casemap)
     /
    if allof (
      anyof (
     header :comparator "i;unicode-casemap" :matches "Subject" [
       "Thankyouforapplying",
       "Thankyouforyourapplication",
       "Thanksforapplying",
       "Applicationreceived*",
       "Yourapplicationhasbeenreceived",
       "Wehavereceivedyourapplication",
       "Thankyouforyourinterest",
       "applicationsubmitted*",
       "hasbeensubmitted",
       "Takfordinansøgning*",
       "Takfordinansogning*",
       "Mangetakfordinansøgning",
       "Ansøgningmodtaget*",
       "Dinansøgningermodtaget*",
       "Viharmodtagetdinansøgning",
       "Takfordininteresse*"
     ]
      ),
      not anyof (
     header :comparator "i;unicode-casemap" :matches "Subject" [
       "reject",
       "declin",
       "unsuccessful",
       "unfortunately",
       "regrettoinform",
       "notmovingforward",
       "notproceed*",
       "anotherdirection*",
       "notselected*",
       "wewillnotbemovingforward*",
       "afslag",
       "desværre",
       "desvaerre",
       "ikkegåvidere",
       "ikkegavidere",
       "gåetvideremedandre*",
       "gaetvideremedandre*",
       "viharvalgtatgåvideremedandre*",
       "ikkekommetibetragtning*"
     ]
      )
    ) {
      fileinto "Job Applications/Confirmations";
      /* Choose ONE of the following:
        If you use Folders and want it out of Inbox, keep only fileinto (no keep/stop needed).
        If you use Labels or want a copy to remain in Inbox too, uncomment keep. */
          // keep;
          stop;
        }
         
     